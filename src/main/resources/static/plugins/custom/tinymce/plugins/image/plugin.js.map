{"version":3,"sources":["image/plugin.js"],"names":["t","merger","global","tinymce","util","Tools","resolve","__assign","Object","assign","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","isType","type","value","x","Array","isPrototypeOf","constructor","name","String","isSimpleType","isString","isObject","isArray","isNull","a","isBoolean","isNumber","noop","constant","never","always","none","NONE","eq","o","isNone","thunk","id","fold","_s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","some","constant_a","self","me","f","v","elementEq","b","Optional","from","nativePush","push","flatten","xs","r","len","head","get","set","window","Function","element","key","dom","console","error","setAttribute","rawSet","fromDom","node","SugarElement","fromHtml","html","scope","div","document","createElement","innerHTML","hasChildNodes","childNodes","fromTag","tag","fromText","text","createTextNode","fromPoint","docElm","y","elementFromPoint","global$1","global$2","global$3","hasDimensions","editor","getParam","getUploadUrl","getUploadHandler","parseIntAndGetMax","val1","val2","Math","max","parseInt","removePixelSuffix","replace","addPixelSuffix","test","mergeMargins","css","margin","splitMargin","split","isPlaceholderImage","imgElm","nodeName","hasAttribute","DOM","getHspace","image","style","marginLeft","marginRight","getVspace","marginTop","marginBottom","getBorder","borderWidth","getAttrib","getAttribute","getStyle","hasCaption","parentNode","updateAttrib","removeAttribute","toggleCaption","figureElm","insertAfter","remove","removeFigure","create","class","appendChild","contentEditable","wrapInFigure","normalizeStyle","normalizeCss","attrValue","setSize","getSize","setHspace","pxValue","setVspace","setBorder","setBorderStyle","borderStyle","isFigure","elm","getIsDecorative","getAlt","getStyleValue","data","hspace","vspace","border","getBorderStyle","read","src","alt","title","width","height","caption","isDecorative","updateProp","oldData","newData","setAlt","setAttrib","sugarImage","normalized","write","_name","_value","updateAlt","cssText","styles","parse","mergedCss","compressed","serialize","getSelectedImage","selection","getNode","getParent","select","splitTextBlock","figure","textBlock","schema","getTextBlockElements","getBody","insertImageAtCaret","focus","setContent","outerHTML","insertedElm","writeImageDataToSelection","syncSrcAttr","selectImage","onload","onerror","nodeChanged","setAttribs","clientWidth","clientHeight","waitLoadImage","deepMerge","old","nu","objects","ret","j","curObject","global$4","getValue","item","sanitizeList","list","extractValue","out","getText","menu","items","sanitizer","extracter","findEntryDelegate","arr","findMap","isGroup","ListUtils","optList","Uploader","settings","defaultHandler","blobInfo","success","failure","progress","xhr","XMLHttpRequest","open","url","withCredentials","credentials","upload","onprogress","e","loaded","total","status","path1","path2","json","JSON","responseText","location","basePath","formData","FormData","append","blob","filename","send","extend","handler","reject","ex","message","uploadBlob","AdvTab","_info","label","columns","inputMode","collect","urlListSanitizer","convertURL","futureImageList","completer","callback","imageList","getImageList","createImageList","classList","getClassList","hasAdvTab$1","hasAdvTab","hasUploadTab$1","hasUploadTab","hasUploadUrl$1","hasUploadUrl","hasUploadHandler$1","hasUploadHandler","readImageDataFromSelection","hasDescription$1","hasDescription","hasImageTitle$1","hasImageTitle","hasDimensions$1","hasImageCaption$1","hasImageCaption","hasAccessibilityOptions","showAccessibilityOptions","getUploadBasePath","getUploadCredentials","automaticUploads","isAutomaticUploadsEnabled","prependURL","getPrependUrl","preUrl","then","makeItems","info","imageDescription","disabled","filetype","MainTab","UploadTab","fromImageData","meta","images","dimensions","classes","borderstyle","fileinput","toImageData","removeEmptyAlt","addPrependUrl","api","getData","srcURL","prependUrl","substring","addPrependUrl2","setData","formFillFromMeta","entry","formFillFromMeta2","changeSrc","helpers","state","imageSize","size","calculateImageSize","prevImage","updateImagesDropdown","changeStyle2","parseStyle","serializeStyle","dataCopy","calcVSpace","calcHSpace","calcBorderWidth","calcBorderStyle","calcStyle","changeFileInput","block","unblock","file","blobUri","URL","createObjectURL","uploader","finalize","revokeObjectURL","updateSrcAndSwitchTab","showTab","reader","FileReader","result","readAsDataURL","dataUrl","createBlobCache","catch","err","alertErr","addToBlobCache","changeHandler","evt","img","prevAlt","changeImages","changeStyle","changeAStyle","disable","enable","closeHandler","makeDialogBody","tabs","makeDialog","createState","body","buttons","primary","initialData","onSubmit","onChange","onClose","submitHandler","execCommand","editorUpload","uploadImagesAuto","close","done","removeChild","visibility","position","bottom","left","getImageSize","documentBaseURI","toAbsolute","blobCache","base64","add","windowManager","alert","normalizeCss$1","stylesArg","Dialog","register","addCommand","_ui","undoManager","transact","partialData","selectedImageData","isEmpty","setCursorLocation","deleteImage","insertOrUpdateImage","hasImageClass","className","attr","toggleContentEditableState","nodes","toggleContentEditable","getAll","on","parser","addNodeFilter","serializer","setup","ui","registry","addToggleButton","icon","tooltip","onAction","onSetup","buttonApi","selectorChangedWithUnbind","setActive","unbind","addMenuItem","addContextMenu","update","register$1"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.6.2 (2020-12-08)\n */\n(function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isNull = eq(null);\n    var isBoolean = isSimpleType('boolean');\n    var isNumber = isSimpleType('number');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var nativePush = Array.prototype.push;\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var get = function (xs, i) {\n      return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n    };\n    var head = function (xs) {\n      return get(xs, 0);\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n    var remove = function (element, key) {\n      element.dom.removeAttribute(key);\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n    var hasDimensions = function (editor) {\n      return editor.getParam('image_dimensions', true, 'boolean');\n    };\n    var hasAdvTab = function (editor) {\n      return editor.getParam('image_advtab', false, 'boolean');\n    };\n    var hasUploadTab = function (editor) {\n      return editor.getParam('image_uploadtab', true, 'boolean');\n    };\n    var getPrependUrl = function (editor) {\n      return editor.getParam('image_prepend_url', '', 'string');\n    };\n    var getClassList = function (editor) {\n      return editor.getParam('image_class_list');\n    };\n    var hasDescription = function (editor) {\n      return editor.getParam('image_description', true, 'boolean');\n    };\n    var hasImageTitle = function (editor) {\n      return editor.getParam('image_title', false, 'boolean');\n    };\n    var hasImageCaption = function (editor) {\n      return editor.getParam('image_caption', false, 'boolean');\n    };\n    var getImageList = function (editor) {\n      return editor.getParam('image_list', false);\n    };\n    var hasUploadUrl = function (editor) {\n      return !!getUploadUrl(editor);\n    };\n    var hasUploadHandler = function (editor) {\n      return !!getUploadHandler(editor);\n    };\n    var getUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url', '', 'string');\n    };\n    var getUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler', undefined, 'function');\n    };\n    var getUploadBasePath = function (editor) {\n      return editor.getParam('images_upload_base_path', undefined, 'string');\n    };\n    var getUploadCredentials = function (editor) {\n      return editor.getParam('images_upload_credentials', false, 'boolean');\n    };\n    var showAccessibilityOptions = function (editor) {\n      return editor.getParam('a11y_advanced_options', false, 'boolean');\n    };\n    var isAutomaticUploadsEnabled = function (editor) {\n      return editor.getParam('automatic_uploads', true, 'boolean');\n    };\n\n    var parseIntAndGetMax = function (val1, val2) {\n      return Math.max(parseInt(val1, 10), parseInt(val2, 10));\n    };\n    var getImageSize = function (url) {\n      return new global$2(function (callback) {\n        var img = document.createElement('img');\n        var done = function (dimensions) {\n          if (img.parentNode) {\n            img.parentNode.removeChild(img);\n          }\n          callback(dimensions);\n        };\n        img.onload = function () {\n          var width = parseIntAndGetMax(img.width, img.clientWidth);\n          var height = parseIntAndGetMax(img.height, img.clientHeight);\n          var dimensions = {\n            width: width,\n            height: height\n          };\n          done(global$2.resolve(dimensions));\n        };\n        img.onerror = function () {\n          done(global$2.reject('Failed to get image dimensions for: ' + url));\n        };\n        var style = img.style;\n        style.visibility = 'hidden';\n        style.position = 'fixed';\n        style.bottom = style.left = '0px';\n        style.width = style.height = 'auto';\n        document.body.appendChild(img);\n        img.src = url;\n      });\n    };\n    var removePixelSuffix = function (value) {\n      if (value) {\n        value = value.replace(/px$/, '');\n      }\n      return value;\n    };\n    var addPixelSuffix = function (value) {\n      if (value.length > 0 && /^[0-9]+$/.test(value)) {\n        value += 'px';\n      }\n      return value;\n    };\n    var mergeMargins = function (css) {\n      if (css.margin) {\n        var splitMargin = String(css.margin).split(' ');\n        switch (splitMargin.length) {\n        case 1:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[0];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n          css['margin-left'] = css['margin-left'] || splitMargin[0];\n          break;\n        case 2:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n          css['margin-left'] = css['margin-left'] || splitMargin[1];\n          break;\n        case 3:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n          css['margin-left'] = css['margin-left'] || splitMargin[1];\n          break;\n        case 4:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n          css['margin-left'] = css['margin-left'] || splitMargin[3];\n        }\n        delete css.margin;\n      }\n      return css;\n    };\n    var createImageList = function (editor, callback) {\n      var imageList = getImageList(editor);\n      if (typeof imageList === 'string') {\n        global$3.send({\n          url: imageList,\n          success: function (text) {\n            callback(JSON.parse(text));\n          }\n        });\n      } else if (typeof imageList === 'function') {\n        imageList(callback);\n      } else {\n        callback(imageList);\n      }\n    };\n    var waitLoadImage = function (editor, data, imgElm) {\n      var selectImage = function () {\n        imgElm.onload = imgElm.onerror = null;\n        if (editor.selection) {\n          editor.selection.select(imgElm);\n          editor.nodeChanged();\n        }\n      };\n      imgElm.onload = function () {\n        if (!data.width && !data.height && hasDimensions(editor)) {\n          editor.dom.setAttribs(imgElm, {\n            width: String(imgElm.clientWidth),\n            height: String(imgElm.clientHeight)\n          });\n        }\n        selectImage();\n      };\n      imgElm.onerror = selectImage;\n    };\n    var blobToDataUri = function (blob) {\n      return new global$2(function (resolve, reject) {\n        var reader = new FileReader();\n        reader.onload = function () {\n          resolve(reader.result);\n        };\n        reader.onerror = function () {\n          reject(reader.error.message);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n    var isPlaceholderImage = function (imgElm) {\n      return imgElm.nodeName === 'IMG' && (imgElm.hasAttribute('data-mce-object') || imgElm.hasAttribute('data-mce-placeholder'));\n    };\n\n    var DOM = global$1.DOM;\n    var getHspace = function (image) {\n      if (image.style.marginLeft && image.style.marginRight && image.style.marginLeft === image.style.marginRight) {\n        return removePixelSuffix(image.style.marginLeft);\n      } else {\n        return '';\n      }\n    };\n    var getVspace = function (image) {\n      if (image.style.marginTop && image.style.marginBottom && image.style.marginTop === image.style.marginBottom) {\n        return removePixelSuffix(image.style.marginTop);\n      } else {\n        return '';\n      }\n    };\n    var getBorder = function (image) {\n      if (image.style.borderWidth) {\n        return removePixelSuffix(image.style.borderWidth);\n      } else {\n        return '';\n      }\n    };\n    var getAttrib = function (image, name) {\n      if (image.hasAttribute(name)) {\n        return image.getAttribute(name);\n      } else {\n        return '';\n      }\n    };\n    var getStyle = function (image, name) {\n      return image.style[name] ? image.style[name] : '';\n    };\n    var hasCaption = function (image) {\n      return image.parentNode !== null && image.parentNode.nodeName === 'FIGURE';\n    };\n    var updateAttrib = function (image, name, value) {\n      if (value === '') {\n        image.removeAttribute(name);\n      } else {\n        image.setAttribute(name, value);\n      }\n    };\n    var wrapInFigure = function (image) {\n      var figureElm = DOM.create('figure', { class: 'image' });\n      DOM.insertAfter(figureElm, image);\n      figureElm.appendChild(image);\n      figureElm.appendChild(DOM.create('figcaption', { contentEditable: 'true' }, 'Caption'));\n      figureElm.contentEditable = 'false';\n    };\n    var removeFigure = function (image) {\n      var figureElm = image.parentNode;\n      DOM.insertAfter(image, figureElm);\n      DOM.remove(figureElm);\n    };\n    var toggleCaption = function (image) {\n      if (hasCaption(image)) {\n        removeFigure(image);\n      } else {\n        wrapInFigure(image);\n      }\n    };\n    var normalizeStyle = function (image, normalizeCss) {\n      var attrValue = image.getAttribute('style');\n      var value = normalizeCss(attrValue !== null ? attrValue : '');\n      if (value.length > 0) {\n        image.setAttribute('style', value);\n        image.setAttribute('data-mce-style', value);\n      } else {\n        image.removeAttribute('style');\n      }\n    };\n    var setSize = function (name, normalizeCss) {\n      return function (image, name, value) {\n        if (image.style[name]) {\n          image.style[name] = addPixelSuffix(value);\n          normalizeStyle(image, normalizeCss);\n        } else {\n          updateAttrib(image, name, value);\n        }\n      };\n    };\n    var getSize = function (image, name) {\n      if (image.style[name]) {\n        return removePixelSuffix(image.style[name]);\n      } else {\n        return getAttrib(image, name);\n      }\n    };\n    var setHspace = function (image, value) {\n      var pxValue = addPixelSuffix(value);\n      image.style.marginLeft = pxValue;\n      image.style.marginRight = pxValue;\n    };\n    var setVspace = function (image, value) {\n      var pxValue = addPixelSuffix(value);\n      image.style.marginTop = pxValue;\n      image.style.marginBottom = pxValue;\n    };\n    var setBorder = function (image, value) {\n      var pxValue = addPixelSuffix(value);\n      image.style.borderWidth = pxValue;\n    };\n    var setBorderStyle = function (image, value) {\n      image.style.borderStyle = value;\n    };\n    var getBorderStyle = function (image) {\n      return getStyle(image, 'borderStyle');\n    };\n    var isFigure = function (elm) {\n      return elm.nodeName === 'FIGURE';\n    };\n    var isImage = function (elm) {\n      return elm.nodeName === 'IMG';\n    };\n    var getIsDecorative = function (image) {\n      return DOM.getAttrib(image, 'alt').length === 0 && DOM.getAttrib(image, 'role') === 'presentation';\n    };\n    var getAlt = function (image) {\n      if (getIsDecorative(image)) {\n        return '';\n      } else {\n        return getAttrib(image, 'alt');\n      }\n    };\n    var defaultData = function () {\n      return {\n        src: '',\n        alt: '',\n        title: '',\n        width: '',\n        height: '',\n        class: '',\n        style: '',\n        caption: false,\n        hspace: '',\n        vspace: '',\n        border: '',\n        borderStyle: '',\n        isDecorative: false\n      };\n    };\n    var getStyleValue = function (normalizeCss, data) {\n      var image = document.createElement('img');\n      updateAttrib(image, 'style', data.style);\n      if (getHspace(image) || data.hspace !== '') {\n        setHspace(image, data.hspace);\n      }\n      if (getVspace(image) || data.vspace !== '') {\n        setVspace(image, data.vspace);\n      }\n      if (getBorder(image) || data.border !== '') {\n        setBorder(image, data.border);\n      }\n      if (getBorderStyle(image) || data.borderStyle !== '') {\n        setBorderStyle(image, data.borderStyle);\n      }\n      return normalizeCss(image.getAttribute('style'));\n    };\n    var create = function (normalizeCss, data) {\n      var image = document.createElement('img');\n      write(normalizeCss, __assign(__assign({}, data), { caption: false }), image);\n      setAlt(image, data.alt, data.isDecorative);\n      if (data.caption) {\n        var figure = DOM.create('figure', { class: 'image' });\n        figure.appendChild(image);\n        figure.appendChild(DOM.create('figcaption', { contentEditable: 'true' }, 'Caption'));\n        figure.contentEditable = 'false';\n        return figure;\n      } else {\n        return image;\n      }\n    };\n    var read = function (normalizeCss, image) {\n      return {\n        src: getAttrib(image, 'src'),\n        alt: getAlt(image),\n        title: getAttrib(image, 'title'),\n        width: getSize(image, 'width'),\n        height: getSize(image, 'height'),\n        class: getAttrib(image, 'class'),\n        style: normalizeCss(getAttrib(image, 'style')),\n        caption: hasCaption(image),\n        hspace: getHspace(image),\n        vspace: getVspace(image),\n        border: getBorder(image),\n        borderStyle: getStyle(image, 'borderStyle'),\n        isDecorative: getIsDecorative(image)\n      };\n    };\n    var updateProp = function (image, oldData, newData, name, set) {\n      if (newData[name] !== oldData[name]) {\n        set(image, name, newData[name]);\n      }\n    };\n    var setAlt = function (image, alt, isDecorative) {\n      if (isDecorative) {\n        DOM.setAttrib(image, 'role', 'presentation');\n        var sugarImage = SugarElement.fromDom(image);\n        set(sugarImage, 'alt', '');\n      } else {\n        if (isNull(alt)) {\n          var sugarImage = SugarElement.fromDom(image);\n          remove(sugarImage, 'alt');\n        } else {\n          var sugarImage = SugarElement.fromDom(image);\n          set(sugarImage, 'alt', alt);\n        }\n        if (DOM.getAttrib(image, 'role') === 'presentation') {\n          DOM.setAttrib(image, 'role', '');\n        }\n      }\n    };\n    var updateAlt = function (image, oldData, newData) {\n      if (newData.alt !== oldData.alt || newData.isDecorative !== oldData.isDecorative) {\n        setAlt(image, newData.alt, newData.isDecorative);\n      }\n    };\n    var normalized = function (set, normalizeCss) {\n      return function (image, name, value) {\n        set(image, value);\n        normalizeStyle(image, normalizeCss);\n      };\n    };\n    var write = function (normalizeCss, newData, image) {\n      var oldData = read(normalizeCss, image);\n      updateProp(image, oldData, newData, 'caption', function (image, _name, _value) {\n        return toggleCaption(image);\n      });\n      updateProp(image, oldData, newData, 'src', updateAttrib);\n      updateProp(image, oldData, newData, 'title', updateAttrib);\n      updateProp(image, oldData, newData, 'width', setSize('width', normalizeCss));\n      updateProp(image, oldData, newData, 'height', setSize('height', normalizeCss));\n      updateProp(image, oldData, newData, 'class', updateAttrib);\n      updateProp(image, oldData, newData, 'style', normalized(function (image, value) {\n        return updateAttrib(image, 'style', value);\n      }, normalizeCss));\n      updateProp(image, oldData, newData, 'hspace', normalized(setHspace, normalizeCss));\n      updateProp(image, oldData, newData, 'vspace', normalized(setVspace, normalizeCss));\n      updateProp(image, oldData, newData, 'border', normalized(setBorder, normalizeCss));\n      updateProp(image, oldData, newData, 'borderStyle', normalized(setBorderStyle, normalizeCss));\n      updateAlt(image, oldData, newData);\n    };\n\n    var normalizeCss = function (editor, cssText) {\n      var css = editor.dom.styles.parse(cssText);\n      var mergedCss = mergeMargins(css);\n      var compressed = editor.dom.styles.parse(editor.dom.styles.serialize(mergedCss));\n      return editor.dom.styles.serialize(compressed);\n    };\n    var getSelectedImage = function (editor) {\n      var imgElm = editor.selection.getNode();\n      var figureElm = editor.dom.getParent(imgElm, 'figure.image');\n      if (figureElm) {\n        return editor.dom.select('img', figureElm)[0];\n      }\n      if (imgElm && (imgElm.nodeName !== 'IMG' || isPlaceholderImage(imgElm))) {\n        return null;\n      }\n      return imgElm;\n    };\n    var splitTextBlock = function (editor, figure) {\n      var dom = editor.dom;\n      var textBlock = dom.getParent(figure.parentNode, function (node) {\n        return !!editor.schema.getTextBlockElements()[node.nodeName];\n      }, editor.getBody());\n      if (textBlock) {\n        return dom.split(textBlock, figure);\n      } else {\n        return figure;\n      }\n    };\n    var readImageDataFromSelection = function (editor) {\n      var image = getSelectedImage(editor);\n      return image ? read(function (css) {\n        return normalizeCss(editor, css);\n      }, image) : defaultData();\n    };\n    var insertImageAtCaret = function (editor, data) {\n      var elm = create(function (css) {\n        return normalizeCss(editor, css);\n      }, data);\n      editor.dom.setAttrib(elm, 'data-mce-id', '__mcenew');\n      editor.focus();\n      editor.selection.setContent(elm.outerHTML);\n      var insertedElm = editor.dom.select('*[data-mce-id=\"__mcenew\"]')[0];\n      editor.dom.setAttrib(insertedElm, 'data-mce-id', null);\n      if (isFigure(insertedElm)) {\n        var figure = splitTextBlock(editor, insertedElm);\n        editor.selection.select(figure);\n      } else {\n        editor.selection.select(insertedElm);\n      }\n    };\n    var syncSrcAttr = function (editor, image) {\n      editor.dom.setAttrib(image, 'src', image.getAttribute('src'));\n    };\n    var deleteImage = function (editor, image) {\n      if (image) {\n        var elm = editor.dom.is(image.parentNode, 'figure.image') ? image.parentNode : image;\n        editor.dom.remove(elm);\n        editor.focus();\n        editor.nodeChanged();\n        if (editor.dom.isEmpty(editor.getBody())) {\n          editor.setContent('');\n          editor.selection.setCursorLocation();\n        }\n      }\n    };\n    var writeImageDataToSelection = function (editor, data) {\n      var image = getSelectedImage(editor);\n      write(function (css) {\n        return normalizeCss(editor, css);\n      }, data, image);\n      syncSrcAttr(editor, image);\n      if (isFigure(image.parentNode)) {\n        var figure = image.parentNode;\n        splitTextBlock(editor, figure);\n        editor.selection.select(image.parentNode);\n      } else {\n        editor.selection.select(image);\n        waitLoadImage(editor, data, image);\n      }\n    };\n    var insertOrUpdateImage = function (editor, partialData) {\n      var image = getSelectedImage(editor);\n      if (image) {\n        var selectedImageData = read(function (css) {\n          return normalizeCss(editor, css);\n        }, image);\n        var data = __assign(__assign({}, selectedImageData), partialData);\n        if (data.src) {\n          writeImageDataToSelection(editor, data);\n        } else {\n          deleteImage(editor, image);\n        }\n      } else if (partialData.src) {\n        insertImageAtCaret(editor, __assign(__assign({}, defaultData()), partialData));\n      }\n    };\n\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n    var deep = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep);\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getValue = function (item) {\n      return isString(item.value) ? item.value : '';\n    };\n    var getText = function (item) {\n      if (isString(item.text)) {\n        return item.text;\n      } else if (isString(item.title)) {\n        return item.title;\n      } else {\n        return '';\n      }\n    };\n    var sanitizeList = function (list, extractValue) {\n      var out = [];\n      global$4.each(list, function (item) {\n        var text = getText(item);\n        if (item.menu !== undefined) {\n          var items = sanitizeList(item.menu, extractValue);\n          out.push({\n            text: text,\n            items: items\n          });\n        } else {\n          var value = extractValue(item);\n          out.push({\n            text: text,\n            value: value\n          });\n        }\n      });\n      return out;\n    };\n    var sanitizer = function (extracter) {\n      if (extracter === void 0) {\n        extracter = getValue;\n      }\n      return function (list) {\n        if (list) {\n          return Optional.from(list).map(function (list) {\n            return sanitizeList(list, extracter);\n          });\n        } else {\n          return Optional.none();\n        }\n      };\n    };\n    var sanitize = function (list) {\n      return sanitizer(getValue)(list);\n    };\n    var isGroup = function (item) {\n      return Object.prototype.hasOwnProperty.call(item, 'items');\n    };\n    var findEntryDelegate = function (list, value) {\n      return findMap(list, function (item) {\n        if (isGroup(item)) {\n          return findEntryDelegate(item.items, value);\n        } else if (item.value === value) {\n          return Optional.some(item);\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var findEntry = function (optList, value) {\n      return optList.bind(function (list) {\n        return findEntryDelegate(list, value);\n      });\n    };\n    var ListUtils = {\n      sanitizer: sanitizer,\n      sanitize: sanitize,\n      findEntry: findEntry\n    };\n\n    var pathJoin = function (path1, path2) {\n      if (path1) {\n        return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n      }\n      return path2;\n    };\n    function Uploader (settings) {\n      var defaultHandler = function (blobInfo, success, failure, progress) {\n        var xhr = new XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n        xhr.onload = function () {\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n          var json = JSON.parse(xhr.responseText);\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n          success(pathJoin(settings.basePath, json.location));\n        };\n        var formData = new FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n      var uploadBlob = function (blobInfo, handler) {\n        return new global$2(function (resolve, reject) {\n          try {\n            handler(blobInfo, resolve, reject, noop);\n          } catch (ex) {\n            reject(ex.message);\n          }\n        });\n      };\n      var isDefaultHandler = function (handler) {\n        return handler === defaultHandler;\n      };\n      var upload = function (blobInfo) {\n        return !settings.url && isDefaultHandler(settings.handler) ? global$2.reject('Upload url missing from the settings.') : uploadBlob(blobInfo, settings.handler);\n      };\n      settings = global$4.extend({\n        credentials: false,\n        handler: defaultHandler\n      }, settings);\n      return { upload: upload };\n    }\n\n    var makeTab = function (_info) {\n      return {\n        title: 'Advanced',\n        name: 'advanced',\n        items: [\n          {\n            type: 'input',\n            label: 'Style',\n            name: 'style'\n          },\n          {\n            type: 'grid',\n            columns: 2,\n            items: [\n              {\n                type: 'input',\n                label: 'Vertical space',\n                name: 'vspace',\n                inputMode: 'numeric'\n              },\n              {\n                type: 'input',\n                label: 'Horizontal space',\n                name: 'hspace',\n                inputMode: 'numeric'\n              },\n              {\n                type: 'input',\n                label: 'Border width',\n                name: 'border',\n                inputMode: 'numeric'\n              },\n              {\n                type: 'listbox',\n                name: 'borderstyle',\n                label: 'Border style',\n                items: [\n                  {\n                    text: 'Select...',\n                    value: ''\n                  },\n                  {\n                    text: 'Solid',\n                    value: 'solid'\n                  },\n                  {\n                    text: 'Dotted',\n                    value: 'dotted'\n                  },\n                  {\n                    text: 'Dashed',\n                    value: 'dashed'\n                  },\n                  {\n                    text: 'Double',\n                    value: 'double'\n                  },\n                  {\n                    text: 'Groove',\n                    value: 'groove'\n                  },\n                  {\n                    text: 'Ridge',\n                    value: 'ridge'\n                  },\n                  {\n                    text: 'Inset',\n                    value: 'inset'\n                  },\n                  {\n                    text: 'Outset',\n                    value: 'outset'\n                  },\n                  {\n                    text: 'None',\n                    value: 'none'\n                  },\n                  {\n                    text: 'Hidden',\n                    value: 'hidden'\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      };\n    };\n    var AdvTab = { makeTab: makeTab };\n\n    var collect = function (editor) {\n      var urlListSanitizer = ListUtils.sanitizer(function (item) {\n        return editor.convertURL(item.value || item.url, 'src');\n      });\n      var futureImageList = new global$2(function (completer) {\n        createImageList(editor, function (imageList) {\n          completer(urlListSanitizer(imageList).map(function (items) {\n            return flatten([\n              [{\n                  text: 'None',\n                  value: ''\n                }],\n              items\n            ]);\n          }));\n        });\n      });\n      var classList = ListUtils.sanitize(getClassList(editor));\n      var hasAdvTab$1 = hasAdvTab(editor);\n      var hasUploadTab$1 = hasUploadTab(editor);\n      var hasUploadUrl$1 = hasUploadUrl(editor);\n      var hasUploadHandler$1 = hasUploadHandler(editor);\n      var image = readImageDataFromSelection(editor);\n      var hasDescription$1 = hasDescription(editor);\n      var hasImageTitle$1 = hasImageTitle(editor);\n      var hasDimensions$1 = hasDimensions(editor);\n      var hasImageCaption$1 = hasImageCaption(editor);\n      var hasAccessibilityOptions = showAccessibilityOptions(editor);\n      var url = getUploadUrl(editor);\n      var basePath = getUploadBasePath(editor);\n      var credentials = getUploadCredentials(editor);\n      var handler = getUploadHandler(editor);\n      var automaticUploads = isAutomaticUploadsEnabled(editor);\n      var prependURL = Optional.some(getPrependUrl(editor)).filter(function (preUrl) {\n        return isString(preUrl) && preUrl.length > 0;\n      });\n      return futureImageList.then(function (imageList) {\n        return {\n          image: image,\n          imageList: imageList,\n          classList: classList,\n          hasAdvTab: hasAdvTab$1,\n          hasUploadTab: hasUploadTab$1,\n          hasUploadUrl: hasUploadUrl$1,\n          hasUploadHandler: hasUploadHandler$1,\n          hasDescription: hasDescription$1,\n          hasImageTitle: hasImageTitle$1,\n          hasDimensions: hasDimensions$1,\n          hasImageCaption: hasImageCaption$1,\n          url: url,\n          basePath: basePath,\n          credentials: credentials,\n          handler: handler,\n          prependURL: prependURL,\n          hasAccessibilityOptions: hasAccessibilityOptions,\n          automaticUploads: automaticUploads\n        };\n      });\n    };\n\n    var makeItems = function (info) {\n      var imageUrl = {\n        name: 'src',\n        type: 'urlinput',\n        filetype: 'image',\n        label: 'Source'\n      };\n      var imageList = info.imageList.map(function (items) {\n        return {\n          name: 'images',\n          type: 'listbox',\n          label: 'Image list',\n          items: items\n        };\n      });\n      var imageDescription = {\n        name: 'alt',\n        type: 'input',\n        label: 'Alternative description',\n        disabled: info.hasAccessibilityOptions && info.image.isDecorative\n      };\n      var imageTitle = {\n        name: 'title',\n        type: 'input',\n        label: 'Image title'\n      };\n      var imageDimensions = {\n        name: 'dimensions',\n        type: 'sizeinput'\n      };\n      var isDecorative = {\n        type: 'label',\n        label: 'Accessibility',\n        items: [{\n            name: 'isDecorative',\n            type: 'checkbox',\n            label: 'Image is decorative'\n          }]\n      };\n      var classList = info.classList.map(function (items) {\n        return {\n          name: 'classes',\n          type: 'listbox',\n          label: 'Class',\n          items: items\n        };\n      });\n      var caption = {\n        type: 'label',\n        label: 'Caption',\n        items: [{\n            type: 'checkbox',\n            name: 'caption',\n            label: 'Show caption'\n          }]\n      };\n      return flatten([\n        [imageUrl],\n        imageList.toArray(),\n        info.hasAccessibilityOptions && info.hasDescription ? [isDecorative] : [],\n        info.hasDescription ? [imageDescription] : [],\n        info.hasImageTitle ? [imageTitle] : [],\n        info.hasDimensions ? [imageDimensions] : [],\n        [{\n            type: 'grid',\n            columns: 2,\n            items: flatten([\n              classList.toArray(),\n              info.hasImageCaption ? [caption] : []\n            ])\n          }]\n      ]);\n    };\n    var makeTab$1 = function (info) {\n      return {\n        title: 'General',\n        name: 'general',\n        items: makeItems(info)\n      };\n    };\n    var MainTab = {\n      makeTab: makeTab$1,\n      makeItems: makeItems\n    };\n\n    var makeTab$2 = function (_info) {\n      var items = [{\n          type: 'dropzone',\n          name: 'fileinput'\n        }];\n      return {\n        title: 'Upload',\n        name: 'upload',\n        items: items\n      };\n    };\n    var UploadTab = { makeTab: makeTab$2 };\n\n    var createState = function (info) {\n      return {\n        prevImage: ListUtils.findEntry(info.imageList, info.image.src),\n        prevAlt: info.image.alt,\n        open: true\n      };\n    };\n    var fromImageData = function (image) {\n      return {\n        src: {\n          value: image.src,\n          meta: {}\n        },\n        images: image.src,\n        alt: image.alt,\n        title: image.title,\n        dimensions: {\n          width: image.width,\n          height: image.height\n        },\n        classes: image.class,\n        caption: image.caption,\n        style: image.style,\n        vspace: image.vspace,\n        border: image.border,\n        hspace: image.hspace,\n        borderstyle: image.borderStyle,\n        fileinput: [],\n        isDecorative: image.isDecorative\n      };\n    };\n    var toImageData = function (data, removeEmptyAlt) {\n      return {\n        src: data.src.value,\n        alt: data.alt.length === 0 && removeEmptyAlt ? null : data.alt,\n        title: data.title,\n        width: data.dimensions.width,\n        height: data.dimensions.height,\n        class: data.classes,\n        style: data.style,\n        caption: data.caption,\n        hspace: data.hspace,\n        vspace: data.vspace,\n        border: data.border,\n        borderStyle: data.borderstyle,\n        isDecorative: data.isDecorative\n      };\n    };\n    var addPrependUrl2 = function (info, srcURL) {\n      if (!/^(?:[a-zA-Z]+:)?\\/\\//.test(srcURL)) {\n        return info.prependURL.bind(function (prependUrl) {\n          if (srcURL.substring(0, prependUrl.length) !== prependUrl) {\n            return Optional.some(prependUrl + srcURL);\n          }\n          return Optional.none();\n        });\n      }\n      return Optional.none();\n    };\n    var addPrependUrl = function (info, api) {\n      var data = api.getData();\n      addPrependUrl2(info, data.src.value).each(function (srcURL) {\n        api.setData({\n          src: {\n            value: srcURL,\n            meta: data.src.meta\n          }\n        });\n      });\n    };\n    var formFillFromMeta2 = function (info, data, meta) {\n      if (info.hasDescription && isString(meta.alt)) {\n        data.alt = meta.alt;\n      }\n      if (info.hasAccessibilityOptions) {\n        data.isDecorative = meta.isDecorative || data.isDecorative || false;\n      }\n      if (info.hasImageTitle && isString(meta.title)) {\n        data.title = meta.title;\n      }\n      if (info.hasDimensions) {\n        if (isString(meta.width)) {\n          data.dimensions.width = meta.width;\n        }\n        if (isString(meta.height)) {\n          data.dimensions.height = meta.height;\n        }\n      }\n      if (isString(meta.class)) {\n        ListUtils.findEntry(info.classList, meta.class).each(function (entry) {\n          data.classes = entry.value;\n        });\n      }\n      if (info.hasImageCaption) {\n        if (isBoolean(meta.caption)) {\n          data.caption = meta.caption;\n        }\n      }\n      if (info.hasAdvTab) {\n        if (isString(meta.style)) {\n          data.style = meta.style;\n        }\n        if (isString(meta.vspace)) {\n          data.vspace = meta.vspace;\n        }\n        if (isString(meta.border)) {\n          data.border = meta.border;\n        }\n        if (isString(meta.hspace)) {\n          data.hspace = meta.hspace;\n        }\n        if (isString(meta.borderstyle)) {\n          data.borderstyle = meta.borderstyle;\n        }\n      }\n    };\n    var formFillFromMeta = function (info, api) {\n      var data = api.getData();\n      var meta = data.src.meta;\n      if (meta !== undefined) {\n        var newData = deepMerge({}, data);\n        formFillFromMeta2(info, newData, meta);\n        api.setData(newData);\n      }\n    };\n    var calculateImageSize = function (helpers, info, state, api) {\n      var data = api.getData();\n      var url = data.src.value;\n      var meta = data.src.meta || {};\n      if (!meta.width && !meta.height && info.hasDimensions) {\n        helpers.imageSize(url).then(function (size) {\n          if (state.open) {\n            api.setData({ dimensions: size });\n          }\n        });\n      }\n    };\n    var updateImagesDropdown = function (info, state, api) {\n      var data = api.getData();\n      var image = ListUtils.findEntry(info.imageList, data.src.value);\n      state.prevImage = image;\n      api.setData({\n        images: image.map(function (entry) {\n          return entry.value;\n        }).getOr('')\n      });\n    };\n    var changeSrc = function (helpers, info, state, api) {\n      addPrependUrl(info, api);\n      formFillFromMeta(info, api);\n      calculateImageSize(helpers, info, state, api);\n      updateImagesDropdown(info, state, api);\n    };\n    var changeImages = function (helpers, info, state, api) {\n      var data = api.getData();\n      var image = ListUtils.findEntry(info.imageList, data.images);\n      image.each(function (img) {\n        var updateAlt = data.alt === '' || state.prevImage.map(function (image) {\n          return image.text === data.alt;\n        }).getOr(false);\n        if (updateAlt) {\n          if (img.value === '') {\n            api.setData({\n              src: img,\n              alt: state.prevAlt\n            });\n          } else {\n            api.setData({\n              src: img,\n              alt: img.text\n            });\n          }\n        } else {\n          api.setData({ src: img });\n        }\n      });\n      state.prevImage = image;\n      changeSrc(helpers, info, state, api);\n    };\n    var calcVSpace = function (css) {\n      var matchingTopBottom = css['margin-top'] && css['margin-bottom'] && css['margin-top'] === css['margin-bottom'];\n      return matchingTopBottom ? removePixelSuffix(String(css['margin-top'])) : '';\n    };\n    var calcHSpace = function (css) {\n      var matchingLeftRight = css['margin-right'] && css['margin-left'] && css['margin-right'] === css['margin-left'];\n      return matchingLeftRight ? removePixelSuffix(String(css['margin-right'])) : '';\n    };\n    var calcBorderWidth = function (css) {\n      return css['border-width'] ? removePixelSuffix(String(css['border-width'])) : '';\n    };\n    var calcBorderStyle = function (css) {\n      return css['border-style'] ? String(css['border-style']) : '';\n    };\n    var calcStyle = function (parseStyle, serializeStyle, css) {\n      return serializeStyle(parseStyle(serializeStyle(css)));\n    };\n    var changeStyle2 = function (parseStyle, serializeStyle, data) {\n      var css = mergeMargins(parseStyle(data.style));\n      var dataCopy = deepMerge({}, data);\n      dataCopy.vspace = calcVSpace(css);\n      dataCopy.hspace = calcHSpace(css);\n      dataCopy.border = calcBorderWidth(css);\n      dataCopy.borderstyle = calcBorderStyle(css);\n      dataCopy.style = calcStyle(parseStyle, serializeStyle, css);\n      return dataCopy;\n    };\n    var changeStyle = function (helpers, api) {\n      var data = api.getData();\n      var newData = changeStyle2(helpers.parseStyle, helpers.serializeStyle, data);\n      api.setData(newData);\n    };\n    var changeAStyle = function (helpers, info, api) {\n      var data = deepMerge(fromImageData(info.image), api.getData());\n      var style = getStyleValue(helpers.normalizeCss, toImageData(data, false));\n      api.setData({ style: style });\n    };\n    var changeFileInput = function (helpers, info, state, api) {\n      var data = api.getData();\n      api.block('Uploading image');\n      head(data.fileinput).fold(function () {\n        api.unblock();\n      }, function (file) {\n        var blobUri = URL.createObjectURL(file);\n        var uploader = Uploader({\n          url: info.url,\n          basePath: info.basePath,\n          credentials: info.credentials,\n          handler: info.handler\n        });\n        var finalize = function () {\n          api.unblock();\n          URL.revokeObjectURL(blobUri);\n        };\n        var updateSrcAndSwitchTab = function (url) {\n          api.setData({\n            src: {\n              value: url,\n              meta: {}\n            }\n          });\n          api.showTab('general');\n          changeSrc(helpers, info, state, api);\n        };\n        blobToDataUri(file).then(function (dataUrl) {\n          var blobInfo = helpers.createBlobCache(file, blobUri, dataUrl);\n          if (info.automaticUploads) {\n            uploader.upload(blobInfo).then(function (url) {\n              updateSrcAndSwitchTab(url);\n              finalize();\n            }).catch(function (err) {\n              finalize();\n              helpers.alertErr(err);\n            });\n          } else {\n            helpers.addToBlobCache(blobInfo);\n            updateSrcAndSwitchTab(blobInfo.blobUri());\n            api.unblock();\n          }\n        });\n      });\n    };\n    var changeHandler = function (helpers, info, state) {\n      return function (api, evt) {\n        if (evt.name === 'src') {\n          changeSrc(helpers, info, state, api);\n        } else if (evt.name === 'images') {\n          changeImages(helpers, info, state, api);\n        } else if (evt.name === 'alt') {\n          state.prevAlt = api.getData().alt;\n        } else if (evt.name === 'style') {\n          changeStyle(helpers, api);\n        } else if (evt.name === 'vspace' || evt.name === 'hspace' || evt.name === 'border' || evt.name === 'borderstyle') {\n          changeAStyle(helpers, info, api);\n        } else if (evt.name === 'fileinput') {\n          changeFileInput(helpers, info, state, api);\n        } else if (evt.name === 'isDecorative') {\n          if (api.getData().isDecorative) {\n            api.disable('alt');\n          } else {\n            api.enable('alt');\n          }\n        }\n      };\n    };\n    var closeHandler = function (state) {\n      return function () {\n        state.open = false;\n      };\n    };\n    var makeDialogBody = function (info) {\n      if (info.hasAdvTab || info.hasUploadUrl || info.hasUploadHandler) {\n        var tabPanel = {\n          type: 'tabpanel',\n          tabs: flatten([\n            [MainTab.makeTab(info)],\n            info.hasAdvTab ? [AdvTab.makeTab(info)] : [],\n            info.hasUploadTab && (info.hasUploadUrl || info.hasUploadHandler) ? [UploadTab.makeTab(info)] : []\n          ])\n        };\n        return tabPanel;\n      } else {\n        var panel = {\n          type: 'panel',\n          items: MainTab.makeItems(info)\n        };\n        return panel;\n      }\n    };\n    var makeDialog = function (helpers) {\n      return function (info) {\n        var state = createState(info);\n        return {\n          title: 'Insert/Edit Image',\n          size: 'normal',\n          body: makeDialogBody(info),\n          buttons: [\n            {\n              type: 'cancel',\n              name: 'cancel',\n              text: 'Cancel'\n            },\n            {\n              type: 'submit',\n              name: 'save',\n              text: 'Save',\n              primary: true\n            }\n          ],\n          initialData: fromImageData(info.image),\n          onSubmit: helpers.onSubmit(info),\n          onChange: changeHandler(helpers, info, state),\n          onClose: closeHandler(state)\n        };\n      };\n    };\n    var submitHandler = function (editor) {\n      return function (info) {\n        return function (api) {\n          var data = deepMerge(fromImageData(info.image), api.getData());\n          editor.execCommand('mceUpdateImage', false, toImageData(data, info.hasAccessibilityOptions));\n          editor.editorUpload.uploadImagesAuto();\n          api.close();\n        };\n      };\n    };\n    var imageSize = function (editor) {\n      return function (url) {\n        return getImageSize(editor.documentBaseURI.toAbsolute(url)).then(function (dimensions) {\n          return {\n            width: String(dimensions.width),\n            height: String(dimensions.height)\n          };\n        });\n      };\n    };\n    var createBlobCache = function (editor) {\n      return function (file, blobUri, dataUrl) {\n        return editor.editorUpload.blobCache.create({\n          blob: file,\n          blobUri: blobUri,\n          name: file.name ? file.name.replace(/\\.[^\\.]+$/, '') : null,\n          filename: file.name,\n          base64: dataUrl.split(',')[1]\n        });\n      };\n    };\n    var addToBlobCache = function (editor) {\n      return function (blobInfo) {\n        editor.editorUpload.blobCache.add(blobInfo);\n      };\n    };\n    var alertErr = function (editor) {\n      return function (message) {\n        editor.windowManager.alert(message);\n      };\n    };\n    var normalizeCss$1 = function (editor) {\n      return function (cssText) {\n        return normalizeCss(editor, cssText);\n      };\n    };\n    var parseStyle = function (editor) {\n      return function (cssText) {\n        return editor.dom.parseStyle(cssText);\n      };\n    };\n    var serializeStyle = function (editor) {\n      return function (stylesArg, name) {\n        return editor.dom.serializeStyle(stylesArg, name);\n      };\n    };\n    var Dialog = function (editor) {\n      var helpers = {\n        onSubmit: submitHandler(editor),\n        imageSize: imageSize(editor),\n        addToBlobCache: addToBlobCache(editor),\n        createBlobCache: createBlobCache(editor),\n        alertErr: alertErr(editor),\n        normalizeCss: normalizeCss$1(editor),\n        parseStyle: parseStyle(editor),\n        serializeStyle: serializeStyle(editor)\n      };\n      var open = function () {\n        collect(editor).then(makeDialog(helpers)).then(editor.windowManager.open);\n      };\n      return { open: open };\n    };\n\n    var register = function (editor) {\n      editor.addCommand('mceImage', Dialog(editor).open);\n      editor.addCommand('mceUpdateImage', function (_ui, data) {\n        editor.undoManager.transact(function () {\n          return insertOrUpdateImage(editor, data);\n        });\n      });\n    };\n\n    var hasImageClass = function (node) {\n      var className = node.attr('class');\n      return className && /\\bimage\\b/.test(className);\n    };\n    var toggleContentEditableState = function (state) {\n      return function (nodes) {\n        var i = nodes.length;\n        var toggleContentEditable = function (node) {\n          node.attr('contenteditable', state ? 'true' : null);\n        };\n        while (i--) {\n          var node = nodes[i];\n          if (hasImageClass(node)) {\n            node.attr('contenteditable', state ? 'false' : null);\n            global$4.each(node.getAll('figcaption'), toggleContentEditable);\n          }\n        }\n      };\n    };\n    var setup = function (editor) {\n      editor.on('PreInit', function () {\n        editor.parser.addNodeFilter('figure', toggleContentEditableState(true));\n        editor.serializer.addNodeFilter('figure', toggleContentEditableState(false));\n      });\n    };\n\n    var register$1 = function (editor) {\n      editor.ui.registry.addToggleButton('image', {\n        icon: 'image',\n        tooltip: 'Insert/edit image',\n        onAction: Dialog(editor).open,\n        onSetup: function (buttonApi) {\n          return editor.selection.selectorChangedWithUnbind('img:not([data-mce-object],[data-mce-placeholder]),figure.image', buttonApi.setActive).unbind;\n        }\n      });\n      editor.ui.registry.addMenuItem('image', {\n        icon: 'image',\n        text: 'Image...',\n        onAction: Dialog(editor).open\n      });\n      editor.ui.registry.addContextMenu('image', {\n        update: function (element) {\n          return isFigure(element) || isImage(element) && !isPlaceholderImage(element) ? ['image'] : [];\n        }\n      });\n    };\n\n    function Plugin () {\n      global.add('image', function (editor) {\n        setup(editor);\n        register$1(editor);\n        register(editor);\n      });\n    }\n\n    Plugin();\n\n}());\n"]}