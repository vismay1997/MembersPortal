{"version":3,"sources":["toc/plugin.min.js"],"names":["n","t","tinymce","util","Tools","resolve","s","f","c","l","getParam","m","e","test","a","Date","getTime","toString","v","o","r","push","join","parseInt","i","$","length","filter","dom","hasClass","parentNode","map","id","level","nodeName","replace","title","text","element","u","d","translate","DOM","encode","undoManager","transact","html","setDisabled","mode","isReadOnly","on","g","ui","registry","addButton","icon","tooltip","onAction","execCommand","onSetup","addMenuItem","addContextToolbar","items","predicate","is","getBody","contains","scope","position","add","addCommand","getParents","insertContent","node","removeAttr","find","attr","children"],"mappings":"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","file":"plugin.min.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.6.2 (2020-12-08)\n */\n!function(){\"use strict\";var e,n,t=tinymce.util.Tools.resolve(\"tinymce.PluginManager\"),s=tinymce.util.Tools.resolve(\"tinymce.dom.DOMUtils\"),f=tinymce.util.Tools.resolve(\"tinymce.util.I18n\"),c=tinymce.util.Tools.resolve(\"tinymce.util.Tools\"),l=function(t){return t.getParam(\"toc_class\",\"mce-toc\")},m=function(t){var e=t.getParam(\"toc_header\",\"h2\");return/^h[1-6]$/.test(e)?e:\"h2\"},a=(e=\"mcetoc_\",n=0,function(){var t=(new Date).getTime().toString(32);return e+t+(n++).toString(32)}),v=function(n){var t,o=l(n),e=m(n),r=function(t){for(var e=[],n=1;n<=t;n++)e.push(\"h\"+n);return e.join(\",\")}(1<=(t=parseInt(n.getParam(\"toc_depth\",\"3\"),10))&&t<=9?t:3),i=n.$(r);return i.length&&/^h[1-9]$/i.test(e)&&(i=i.filter(function(t,e){return!n.dom.hasClass(e.parentNode,o)})),c.map(i,function(t){var e=t.id;return{id:e||a(),level:parseInt(t.nodeName.replace(/^H/i,\"\"),10),title:n.$.text(t),element:t}})},u=function(t){var e,n,o,r,i,c,l,a=\"\",u=v(t),d=function(t){for(var e=9,n=0;n<t.length;n++)if(t[n].level<e&&(e=t[n].level),1===e)return e;return e}(u)-1;if(!u.length)return\"\";for(a+=(i=m(t),c=f.translate(\"Table of Contents\"),l=\"</\"+i+\">\",\"<\"+i+' contenteditable=\"true\">'+s.DOM.encode(c)+l),e=0;e<u.length;e++){if((o=u[e]).element.id=o.id,r=u[e+1]&&u[e+1].level,d===o.level)a+=\"<li>\";else for(n=d;n<o.level;n++)a+=\"<ul><li>\";if(a+='<a href=\"#'+o.id+'\">'+o.title+\"</a>\",r!==o.level&&r)for(n=o.level;r<n;n--)a+=\"</li></ul><li>\";else a+=\"</li>\",r||(a+=\"</ul>\");d=o.level}return a},i=function(t){var e,n,o,r,i=l(t),c=t.$(\".\"+i);o=t,!(r=c).length||0<o.dom.getParents(r[0],\".mce-offscreen-selection\").length?t.insertContent((n=u(e=t),'<div class=\"'+e.dom.encode(l(e))+'\" contenteditable=\"false\">'+n+\"</div>\")):d(t)},d=function(t){var e=l(t),n=t.$(\".\"+e);n.length&&t.undoManager.transact(function(){n.html(u(t))})},o=function(n){return function(t){var e=function(){return t.setDisabled(n.mode.isReadOnly()||!(0<v(n).length))};return e(),n.on(\"LoadContent SetContent change\",e),function(){return n.on(\"LoadContent SetContent change\",e)}}},g=function(t){var e;t.ui.registry.addButton(\"toc\",{icon:\"toc\",tooltip:\"Table of contents\",onAction:function(){return t.execCommand(\"mceInsertToc\")},onSetup:o(t)}),t.ui.registry.addButton(\"tocupdate\",{icon:\"reload\",tooltip:\"Update\",onAction:function(){return t.execCommand(\"mceUpdateToc\")}}),t.ui.registry.addMenuItem(\"toc\",{icon:\"toc\",text:\"Table of contents\",onAction:function(){return t.execCommand(\"mceInsertToc\")},onSetup:o(t)}),t.ui.registry.addContextToolbar(\"toc\",{items:\"tocupdate\",predicate:(e=t,function(t){return t&&e.dom.is(t,\".\"+l(e))&&e.getBody().contains(t)}),scope:\"node\",position:\"node\"})};t.add(\"toc\",function(t){var e,n,o,r;(e=t).addCommand(\"mceInsertToc\",function(){i(e)}),e.addCommand(\"mceUpdateToc\",function(){d(e)}),g(t),o=(n=t).$,r=l(n),n.on(\"PreProcess\",function(t){var e=o(\".\"+r,t.node);e.length&&(e.removeAttr(\"contentEditable\"),e.find(\"[contenteditable]\").removeAttr(\"contentEditable\"))}),n.on(\"SetContent\",function(){var t=o(\".\"+r);t.length&&(t.attr(\"contentEditable\",!1),t.children(\":first-child\").attr(\"contentEditable\",!0))})})}();"]}