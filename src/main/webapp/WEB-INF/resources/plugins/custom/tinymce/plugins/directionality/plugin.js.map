{"version":3,"sources":["directionality/plugin.js"],"names":["eq","call","id","global","tinymce","util","Tools","resolve","global$1","setDir","editor","dir","curDir","dom","blocks","selection","getSelectedBlocks","length","getAttrib","each","block","getParent","parentNode","getRoot","setAttrib","nodeChanged","noop","constant","value","never","always","none","NONE","o","isNone","fold","n","_s","is","isSome","getOr","getOrThunk","thunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","bind","exists","forall","filter","equals","equals_","toArray","toString","some","a","constant_a","self","me","f","s","v","elementEq","b","Optional","from","isFunction","type","isSimpleType","fromDom","node","SugarElement","fromHtml","html","scope","div","document","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromTag","tag","fromText","text","createTextNode","fromPoint","docElm","x","y","elementFromPoint","isType","window","Function","t","element","nodeType","isText","isDocument","isDocumentFragment","getRootNode","Element","prototype","attachShadow","Node","e","dos","ownerDocument","getShadowRoot","r","getShadowHost","host","inBody","fbc","fab","doc","body","contains","getUnsafeProperty","property","style","getPropertyValue","isSupported","getDirection","getComputedStyle","get","getNodeChangeHandler","api","nodeChangeHandler","setActive","on","off","add","addCommand","register","ui","registry","addToggleButton","tooltip","icon","onAction","execCommand","onSetup","register$1"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.6.2 (2020-12-08)\n */\n(function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var setDir = function (editor, dir) {\n      var dom = editor.dom;\n      var curDir;\n      var blocks = editor.selection.getSelectedBlocks();\n      if (blocks.length) {\n        curDir = dom.getAttrib(blocks[0], 'dir');\n        global$1.each(blocks, function (block) {\n          if (!dom.getParent(block.parentNode, '*[dir=\"' + dir + '\"]', dom.getRoot())) {\n            dom.setAttrib(block, 'dir', curDir !== dir ? dir : null);\n          }\n        });\n        editor.nodeChanged();\n      }\n    };\n\n    var register = function (editor) {\n      editor.addCommand('mceDirectionLTR', function () {\n        setDir(editor, 'ltr');\n      });\n      editor.addCommand('mceDirectionRTL', function () {\n        setDir(editor, 'rtl');\n      });\n    };\n\n    var noop = function () {\n    };\n    var compose1 = function (fbc, fab) {\n      return function (a) {\n        return fbc(fab(a));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var isFunction = isSimpleType('function');\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var TEXT = 3;\n\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isText = isType(TEXT);\n    var isDocument = isType(DOCUMENT);\n    var isDocumentFragment = isType(DOCUMENT_FRAGMENT);\n\n    var owner = function (element) {\n      return SugarElement.fromDom(element.dom.ownerDocument);\n    };\n    var documentOrOwner = function (dos) {\n      return isDocument(dos) ? dos : owner(dos);\n    };\n\n    var isShadowRoot = function (dos) {\n      return isDocumentFragment(dos);\n    };\n    var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n    var getRootNode = supported ? function (e) {\n      return SugarElement.fromDom(e.dom.getRootNode());\n    } : documentOrOwner;\n    var getShadowRoot = function (e) {\n      var r = getRootNode(e);\n      return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n    };\n    var getShadowHost = function (e) {\n      return SugarElement.fromDom(e.dom.host);\n    };\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom.parentNode : element.dom;\n      if (dom === undefined || dom === null || dom.ownerDocument === null) {\n        return false;\n      }\n      var doc = dom.ownerDocument;\n      return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n        return doc.body.contains(dom);\n      }, compose1(inBody, getShadowHost));\n    };\n\n    var get = function (element, property) {\n      var dom = element.dom;\n      var styles = window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n\n    var getDirection = function (element) {\n      return get(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var getNodeChangeHandler = function (editor, dir) {\n      return function (api) {\n        var nodeChangeHandler = function (e) {\n          var element = SugarElement.fromDom(e.element);\n          api.setActive(getDirection(element) === dir);\n        };\n        editor.on('NodeChange', nodeChangeHandler);\n        return function () {\n          return editor.off('NodeChange', nodeChangeHandler);\n        };\n      };\n    };\n    var register$1 = function (editor) {\n      editor.ui.registry.addToggleButton('ltr', {\n        tooltip: 'Left to right',\n        icon: 'ltr',\n        onAction: function () {\n          return editor.execCommand('mceDirectionLTR');\n        },\n        onSetup: getNodeChangeHandler(editor, 'ltr')\n      });\n      editor.ui.registry.addToggleButton('rtl', {\n        tooltip: 'Right to left',\n        icon: 'rtl',\n        onAction: function () {\n          return editor.execCommand('mceDirectionRTL');\n        },\n        onSetup: getNodeChangeHandler(editor, 'rtl')\n      });\n    };\n\n    function Plugin () {\n      global.add('directionality', function (editor) {\n        register(editor);\n        register$1(editor);\n      });\n    }\n\n    Plugin();\n\n}());\n"]}