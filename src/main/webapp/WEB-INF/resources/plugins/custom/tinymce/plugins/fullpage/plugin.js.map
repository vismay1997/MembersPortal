{"version":3,"sources":["fullpage/plugin.js"],"names":["Cell","initial","value","get","set","v","global","tinymce","util","Tools","resolve","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","global$1","global$2","global$3","global$4","shouldHideInSourceView","editor","getParam","getDefaultEncoding","getDefaultFontFamily","getDefaultFontSize","parseHeader","head","validate","root_name","parse","format","open","headState","data","elm","matches","headerFragment","getAttr","name","attr","fontface","fontsize","firstChild","type","xml_pi","exec","docencoding","getAll","doctype","title","each","meta","httpEquiv","toLowerCase","langcode","stylesheets","link","push","langdir","style","visited_color","link_color","active_color","htmlToData","initialData","keywords","description","robots","author","windowManager","size","body","items","label","buttons","text","primary","onSubmit","api","nuData","getData","headHtml","headElement","dom","setAttr","undefined","addHeadNode","node","insert","append","remove","substring","shortEnded","empty","split","nodes","currentStyleSheetsMap","stylesheet","rel","href","setAttribs","getBody","dir","vLink","aLink","html","indent","indent_before","indent_after","serialize","indexOf","dataToHtml","extend","close","low","replace","a","handleSetContent","footState","evt","startPos","endPos","content","protect","styles","selection","getProtect","pattern","str","escape","source_view","trim","getDefaultHeader","bodyElm","headElm","getDoc","getElementsByTagName","add","id","appendChild","document","createTextNode","getAttribute","data-mce-fullpage","parentNode","removeChild","header","getDefaultXmlPi","piEncoding","getDefaultDocType","getDefaultTitle","getDefaultTextColor","handleGetContent","foot","m","unescape","addCommand","register","ui","registry","addButton","tooltip","icon","onAction","execCommand","addMenuItem","register$1","on","setup"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.6.2 (2020-12-08)\n */\n(function () {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.html.DomParser');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.html.Node');\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.html.Serializer');\n\n    var shouldHideInSourceView = function (editor) {\n      return editor.getParam('fullpage_hide_in_source_view');\n    };\n    var getDefaultXmlPi = function (editor) {\n      return editor.getParam('fullpage_default_xml_pi');\n    };\n    var getDefaultEncoding = function (editor) {\n      return editor.getParam('fullpage_default_encoding');\n    };\n    var getDefaultFontFamily = function (editor) {\n      return editor.getParam('fullpage_default_font_family');\n    };\n    var getDefaultFontSize = function (editor) {\n      return editor.getParam('fullpage_default_font_size');\n    };\n    var getDefaultTextColor = function (editor) {\n      return editor.getParam('fullpage_default_text_color');\n    };\n    var getDefaultTitle = function (editor) {\n      return editor.getParam('fullpage_default_title');\n    };\n    var getDefaultDocType = function (editor) {\n      return editor.getParam('fullpage_default_doctype', '<!DOCTYPE html>');\n    };\n    var getProtect = function (editor) {\n      return editor.getParam('protect');\n    };\n\n    var parseHeader = function (head) {\n      return global$2({\n        validate: false,\n        root_name: '#document'\n      }).parse(head, { format: 'xhtml' });\n    };\n    var htmlToData = function (editor, head) {\n      var headerFragment = parseHeader(head);\n      var data = {};\n      var elm, matches;\n      function getAttr(elm, name) {\n        var value = elm.attr(name);\n        return value || '';\n      }\n      data.fontface = getDefaultFontFamily(editor);\n      data.fontsize = getDefaultFontSize(editor);\n      elm = headerFragment.firstChild;\n      if (elm.type === 7) {\n        data.xml_pi = true;\n        matches = /encoding=\"([^\"]+)\"/.exec(elm.value);\n        if (matches) {\n          data.docencoding = matches[1];\n        }\n      }\n      elm = headerFragment.getAll('#doctype')[0];\n      if (elm) {\n        data.doctype = '<!DOCTYPE' + elm.value + '>';\n      }\n      elm = headerFragment.getAll('title')[0];\n      if (elm && elm.firstChild) {\n        data.title = elm.firstChild.value;\n      }\n      global$1.each(headerFragment.getAll('meta'), function (meta) {\n        var name = meta.attr('name');\n        var httpEquiv = meta.attr('http-equiv');\n        var matches;\n        if (name) {\n          data[name.toLowerCase()] = meta.attr('content');\n        } else if (httpEquiv === 'Content-Type') {\n          matches = /charset\\s*=\\s*(.*)\\s*/gi.exec(meta.attr('content'));\n          if (matches) {\n            data.docencoding = matches[1];\n          }\n        }\n      });\n      elm = headerFragment.getAll('html')[0];\n      if (elm) {\n        data.langcode = getAttr(elm, 'lang') || getAttr(elm, 'xml:lang');\n      }\n      data.stylesheets = [];\n      global$1.each(headerFragment.getAll('link'), function (link) {\n        if (link.attr('rel') === 'stylesheet') {\n          data.stylesheets.push(link.attr('href'));\n        }\n      });\n      elm = headerFragment.getAll('body')[0];\n      if (elm) {\n        data.langdir = getAttr(elm, 'dir');\n        data.style = getAttr(elm, 'style');\n        data.visited_color = getAttr(elm, 'vlink');\n        data.link_color = getAttr(elm, 'link');\n        data.active_color = getAttr(elm, 'alink');\n      }\n      return data;\n    };\n    var dataToHtml = function (editor, data, head) {\n      var headElement, elm, value;\n      var dom = editor.dom;\n      function setAttr(elm, name, value) {\n        elm.attr(name, value ? value : undefined);\n      }\n      function addHeadNode(node) {\n        if (headElement.firstChild) {\n          headElement.insert(node, headElement.firstChild);\n        } else {\n          headElement.append(node);\n        }\n      }\n      var headerFragment = parseHeader(head);\n      headElement = headerFragment.getAll('head')[0];\n      if (!headElement) {\n        elm = headerFragment.getAll('html')[0];\n        headElement = new global$3('head', 1);\n        if (elm.firstChild) {\n          elm.insert(headElement, elm.firstChild, true);\n        } else {\n          elm.append(headElement);\n        }\n      }\n      elm = headerFragment.firstChild;\n      if (data.xml_pi) {\n        value = 'version=\"1.0\"';\n        if (data.docencoding) {\n          value += ' encoding=\"' + data.docencoding + '\"';\n        }\n        if (elm.type !== 7) {\n          elm = new global$3('xml', 7);\n          headerFragment.insert(elm, headerFragment.firstChild, true);\n        }\n        elm.value = value;\n      } else if (elm && elm.type === 7) {\n        elm.remove();\n      }\n      elm = headerFragment.getAll('#doctype')[0];\n      if (data.doctype) {\n        if (!elm) {\n          elm = new global$3('#doctype', 10);\n          if (data.xml_pi) {\n            headerFragment.insert(elm, headerFragment.firstChild);\n          } else {\n            addHeadNode(elm);\n          }\n        }\n        elm.value = data.doctype.substring(9, data.doctype.length - 1);\n      } else if (elm) {\n        elm.remove();\n      }\n      elm = null;\n      global$1.each(headerFragment.getAll('meta'), function (meta) {\n        if (meta.attr('http-equiv') === 'Content-Type') {\n          elm = meta;\n        }\n      });\n      if (data.docencoding) {\n        if (!elm) {\n          elm = new global$3('meta', 1);\n          elm.attr('http-equiv', 'Content-Type');\n          elm.shortEnded = true;\n          addHeadNode(elm);\n        }\n        elm.attr('content', 'text/html; charset=' + data.docencoding);\n      } else if (elm) {\n        elm.remove();\n      }\n      elm = headerFragment.getAll('title')[0];\n      if (data.title) {\n        if (!elm) {\n          elm = new global$3('title', 1);\n          addHeadNode(elm);\n        } else {\n          elm.empty();\n        }\n        elm.append(new global$3('#text', 3)).value = data.title;\n      } else if (elm) {\n        elm.remove();\n      }\n      global$1.each('keywords,description,author,copyright,robots'.split(','), function (name) {\n        var nodes = headerFragment.getAll('meta');\n        var i, meta;\n        var value = data[name];\n        for (i = 0; i < nodes.length; i++) {\n          meta = nodes[i];\n          if (meta.attr('name') === name) {\n            if (value) {\n              meta.attr('content', value);\n            } else {\n              meta.remove();\n            }\n            return;\n          }\n        }\n        if (value) {\n          elm = new global$3('meta', 1);\n          elm.attr('name', name);\n          elm.attr('content', value);\n          elm.shortEnded = true;\n          addHeadNode(elm);\n        }\n      });\n      var currentStyleSheetsMap = {};\n      global$1.each(headerFragment.getAll('link'), function (stylesheet) {\n        if (stylesheet.attr('rel') === 'stylesheet') {\n          currentStyleSheetsMap[stylesheet.attr('href')] = stylesheet;\n        }\n      });\n      global$1.each(data.stylesheets, function (stylesheet) {\n        if (!currentStyleSheetsMap[stylesheet]) {\n          elm = new global$3('link', 1);\n          elm.attr({\n            rel: 'stylesheet',\n            text: 'text/css',\n            href: stylesheet\n          });\n          elm.shortEnded = true;\n          addHeadNode(elm);\n        }\n        delete currentStyleSheetsMap[stylesheet];\n      });\n      global$1.each(currentStyleSheetsMap, function (stylesheet) {\n        stylesheet.remove();\n      });\n      elm = headerFragment.getAll('body')[0];\n      if (elm) {\n        setAttr(elm, 'dir', data.langdir);\n        setAttr(elm, 'style', data.style);\n        setAttr(elm, 'vlink', data.visited_color);\n        setAttr(elm, 'link', data.link_color);\n        setAttr(elm, 'alink', data.active_color);\n        dom.setAttribs(editor.getBody(), {\n          style: data.style,\n          dir: data.dir,\n          vLink: data.visited_color,\n          link: data.link_color,\n          aLink: data.active_color\n        });\n      }\n      elm = headerFragment.getAll('html')[0];\n      if (elm) {\n        setAttr(elm, 'lang', data.langcode);\n        setAttr(elm, 'xml:lang', data.langcode);\n      }\n      if (!headElement.firstChild) {\n        headElement.remove();\n      }\n      var html = global$4({\n        validate: false,\n        indent: true,\n        indent_before: 'head,html,body,meta,title,script,link,style',\n        indent_after: 'head,html,body,meta,title,script,link,style'\n      }).serialize(headerFragment);\n      return html.substring(0, html.indexOf('</body>'));\n    };\n\n    var open = function (editor, headState) {\n      var data = htmlToData(editor, headState.get());\n      var defaultData = {\n        title: '',\n        keywords: '',\n        description: '',\n        robots: '',\n        author: '',\n        docencoding: ''\n      };\n      var initialData = __assign(__assign({}, defaultData), data);\n      editor.windowManager.open({\n        title: 'Metadata and Document Properties',\n        size: 'normal',\n        body: {\n          type: 'panel',\n          items: [\n            {\n              name: 'title',\n              type: 'input',\n              label: 'Title'\n            },\n            {\n              name: 'keywords',\n              type: 'input',\n              label: 'Keywords'\n            },\n            {\n              name: 'description',\n              type: 'input',\n              label: 'Description'\n            },\n            {\n              name: 'robots',\n              type: 'input',\n              label: 'Robots'\n            },\n            {\n              name: 'author',\n              type: 'input',\n              label: 'Author'\n            },\n            {\n              name: 'docencoding',\n              type: 'input',\n              label: 'Encoding'\n            }\n          ]\n        },\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: initialData,\n        onSubmit: function (api) {\n          var nuData = api.getData();\n          var headHtml = dataToHtml(editor, global$1.extend(data, nuData), headState.get());\n          headState.set(headHtml);\n          api.close();\n        }\n      });\n    };\n\n    var register = function (editor, headState) {\n      editor.addCommand('mceFullPageProperties', function () {\n        open(editor, headState);\n      });\n    };\n\n    var protectHtml = function (protect, html) {\n      global$1.each(protect, function (pattern) {\n        html = html.replace(pattern, function (str) {\n          return '<!--mce:protected ' + escape(str) + '-->';\n        });\n      });\n      return html;\n    };\n    var unprotectHtml = function (html) {\n      return html.replace(/<!--mce:protected ([\\s\\S]*?)-->/g, function (a, m) {\n        return unescape(m);\n      });\n    };\n\n    var each = global$1.each;\n    var low = function (s) {\n      return s.replace(/<\\/?[A-Z]+/g, function (a) {\n        return a.toLowerCase();\n      });\n    };\n    var handleSetContent = function (editor, headState, footState, evt) {\n      var startPos, endPos, content, styles = '';\n      var dom = editor.dom;\n      if (evt.selection) {\n        return;\n      }\n      content = protectHtml(getProtect(editor), evt.content);\n      if (evt.format === 'raw' && headState.get()) {\n        return;\n      }\n      if (evt.source_view && shouldHideInSourceView(editor)) {\n        return;\n      }\n      if (content.length === 0 && !evt.source_view) {\n        content = global$1.trim(headState.get()) + '\\n' + global$1.trim(content) + '\\n' + global$1.trim(footState.get());\n      }\n      content = content.replace(/<(\\/?)BODY/gi, '<$1body');\n      startPos = content.indexOf('<body');\n      if (startPos !== -1) {\n        startPos = content.indexOf('>', startPos);\n        headState.set(low(content.substring(0, startPos + 1)));\n        endPos = content.indexOf('</body', startPos);\n        if (endPos === -1) {\n          endPos = content.length;\n        }\n        evt.content = global$1.trim(content.substring(startPos + 1, endPos));\n        footState.set(low(content.substring(endPos)));\n      } else {\n        headState.set(getDefaultHeader(editor));\n        footState.set('\\n</body>\\n</html>');\n      }\n      var headerFragment = parseHeader(headState.get());\n      each(headerFragment.getAll('style'), function (node) {\n        if (node.firstChild) {\n          styles += node.firstChild.value;\n        }\n      });\n      var bodyElm = headerFragment.getAll('body')[0];\n      if (bodyElm) {\n        dom.setAttribs(editor.getBody(), {\n          style: bodyElm.attr('style') || '',\n          dir: bodyElm.attr('dir') || '',\n          vLink: bodyElm.attr('vlink') || '',\n          link: bodyElm.attr('link') || '',\n          aLink: bodyElm.attr('alink') || ''\n        });\n      }\n      dom.remove('fullpage_styles');\n      var headElm = editor.getDoc().getElementsByTagName('head')[0];\n      if (styles) {\n        var styleElm = dom.add(headElm, 'style', { id: 'fullpage_styles' });\n        styleElm.appendChild(document.createTextNode(styles));\n      }\n      var currentStyleSheetsMap = {};\n      global$1.each(headElm.getElementsByTagName('link'), function (stylesheet) {\n        if (stylesheet.rel === 'stylesheet' && stylesheet.getAttribute('data-mce-fullpage')) {\n          currentStyleSheetsMap[stylesheet.href] = stylesheet;\n        }\n      });\n      global$1.each(headerFragment.getAll('link'), function (stylesheet) {\n        var href = stylesheet.attr('href');\n        if (!href) {\n          return true;\n        }\n        if (!currentStyleSheetsMap[href] && stylesheet.attr('rel') === 'stylesheet') {\n          dom.add(headElm, 'link', {\n            'rel': 'stylesheet',\n            'text': 'text/css',\n            href: href,\n            'data-mce-fullpage': '1'\n          });\n        }\n        delete currentStyleSheetsMap[href];\n      });\n      global$1.each(currentStyleSheetsMap, function (stylesheet) {\n        stylesheet.parentNode.removeChild(stylesheet);\n      });\n    };\n    var getDefaultHeader = function (editor) {\n      var header = '', value, styles = '';\n      if (getDefaultXmlPi(editor)) {\n        var piEncoding = getDefaultEncoding(editor);\n        header += '<?xml version=\"1.0\" encoding=\"' + (piEncoding ? piEncoding : 'ISO-8859-1') + '\" ?>\\n';\n      }\n      header += getDefaultDocType(editor);\n      header += '\\n<html>\\n<head>\\n';\n      if (value = getDefaultTitle(editor)) {\n        header += '<title>' + value + '</title>\\n';\n      }\n      if (value = getDefaultEncoding(editor)) {\n        header += '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=' + value + '\" />\\n';\n      }\n      if (value = getDefaultFontFamily(editor)) {\n        styles += 'font-family: ' + value + ';';\n      }\n      if (value = getDefaultFontSize(editor)) {\n        styles += 'font-size: ' + value + ';';\n      }\n      if (value = getDefaultTextColor(editor)) {\n        styles += 'color: ' + value + ';';\n      }\n      header += '</head>\\n<body' + (styles ? ' style=\"' + styles + '\"' : '') + '>\\n';\n      return header;\n    };\n    var handleGetContent = function (editor, head, foot, evt) {\n      if (evt.format === 'html' && !evt.selection && (!evt.source_view || !shouldHideInSourceView(editor))) {\n        evt.content = unprotectHtml(global$1.trim(head) + '\\n' + global$1.trim(evt.content) + '\\n' + global$1.trim(foot));\n      }\n    };\n    var setup = function (editor, headState, footState) {\n      editor.on('BeforeSetContent', function (evt) {\n        handleSetContent(editor, headState, footState, evt);\n      });\n      editor.on('GetContent', function (evt) {\n        handleGetContent(editor, headState.get(), footState.get(), evt);\n      });\n    };\n\n    var register$1 = function (editor) {\n      editor.ui.registry.addButton('fullpage', {\n        tooltip: 'Metadata and document properties',\n        icon: 'document-properties',\n        onAction: function () {\n          editor.execCommand('mceFullPageProperties');\n        }\n      });\n      editor.ui.registry.addMenuItem('fullpage', {\n        text: 'Metadata and document properties',\n        icon: 'document-properties',\n        onAction: function () {\n          editor.execCommand('mceFullPageProperties');\n        }\n      });\n    };\n\n    function Plugin () {\n      global.add('fullpage', function (editor) {\n        var headState = Cell(''), footState = Cell('');\n        register(editor, headState);\n        register$1(editor);\n        setup(editor, headState, footState);\n      });\n    }\n\n    Plugin();\n\n}());\n"]}